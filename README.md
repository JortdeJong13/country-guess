# Country Shape Recognition App

Welcome to the Country Shape Recognition App! This Python-based machine learning application allows users to draw a country shape in the browser. A Convolutional Neural Network will then guess which country has been drawn. Users can confirm this guess or select the correct country from a dropdown list.

## Table of Contents

- [Screenshots](#screenshots)
- [Getting Started](#getting-started)
  - [Local Installation](#local-installation)
  - [Docker Installation](#docker-installation)
- [Usage](#usage)
  - [Running the App](#running-the-app)
  - [Jupyter Notebooks](#jupyter-notebooks)
- [Architecture and Design](#architecture-and-design)
- [License](#license)

## Screenshots

![Drawing](images/Drawing.png)
![Prediction](images/Prediction.png)

## Getting Started

### Local Installation

1. Navigate to the project directory.
2. Install the required packages:
‘''pip install -r mlserver/requirements.txt
   pip install -r webapp/requirements.txt’''
3. Set env variable MODEL_NAME 
'''export MODEL_NAME
4. Run the ML server:
‘''python mlserver/serve.py'''
5. Start the web app:
‘’’python webapp/app.py’''
6. Access the web app at http://localhost:5000

### Docker Installation
1. Navigate to the project directory.
2. Run the app using Docker Compose:
‘’’Docker-compose up -d’''
3. Access the web app at http://localhost:5000

## Usage

### Running the app

Once the app is running, you can draw a country shape in the browser. The ML model will guess the country, and you can confirm or correct the guess using a dropdown list.

### Jupyter Notebooks

The repository also holds two Jupyter notebooks: the Manipulate Data notebook and the Model Training notebook. The Manipulate Data notebook can be used to alter the reference country shapes data and investigate how the reference data has been modified from the original source. Additionally, this notebook allows users to investigate and delete country drawings made by users. These user drawings are included in the test set when training a model.

The Model Training notebook is designed to train a machine learning model using a basic CNN with a triplet training objective. The training data is generated by augmenting the reference country shapes to resemble user drawings. For example, the reference country shape is simplified, smoothed, and subjected to a series of geometric augmentations. Small polygons are also randomly removed to simulate the user forgetting to draw small islands.

When training a model, users can start an MLflow Tracking server by running the mlflow ui command. This server logs the model training process, allowing users to compare different runs and register models through the UI. The model name can be set in the docker-compose.yml file. The ML server will select the model with the “champion” alias.

Example of synthetic drawing augmentation:

## Architecture and design

The architecture and design of the app can be visualized with the following diagram:

The application consists of two main services as described in the docker-compose.yml file: the ML server and the web app. The ML server image is built using a copy of the reference data. To preserve user drawings, the user data is mounted as a volume. If no user data is mounted, the drawings made by users will not persist outside the Docker container.

If the mlruns volume is not mounted, the ML server will fall back on a default model embedded within the image. Users can change the model name in the docker-compose.yml file, and the ML server will select the model with the “champion” alias.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
